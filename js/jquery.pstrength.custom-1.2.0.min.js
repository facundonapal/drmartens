/* jQuery Password Strength Plugin (pstrength) - A jQuery plugin to provide accessibility functions
 * Author: Tane Piper (digitalspaghetti@gmail.com)
 * Website: http://digitalspaghetti.me.uk
 * Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
 * This code uses a modified version of Steve Moitozo's algorithm (http://www.geekwisdom.com/dyn/passwdmeter)
 *
 * === Changelog ===
 * Version 1.2 (03/09/2007)
 * Added more options for colors and common words
 * Added common words checked to see if words like 'password' or 'qwerty' are being entered
 * Added minimum characters required for password
 * Re-worked scoring system to give better results
 *
 * Version 1.1 (20/08/2007)
 * Changed code to be more jQuery-like
 *
 * Version 1.0 (20/07/2007)
 * Initial version.
 */
!function(r){r.extend(r.fn,{pstrength:function(a){a=r.extend({verdicts:["Too Short!","Very Weak","Weak","Medium","Strong","Very Strong"],colors:["#ccc","#f00","#c06","#f60","#3c0","#3f0"],values:[20,30,40,60,80,100],scores:[10,15,30,40],minchar:6,minCharText:"Minimum length is %d characters"},a);return this.each(function(){var c=r(this).attr("id");r(this).after('<div id="'+c+'_bar" class="progress" style="display: none;"><div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"><span  id="'+c+'_text">0%<span></div></div>'),a.minchar>0&&r(this).after('<div class="help-block" id="'+c+'_minchar">'+a.minCharText.replace("%d",a.minchar)+"</div>"),a.$ctlBar=r("#"+c+"_bar .progress-bar"),a.$ctlText=r("#"+c+"_text"),r(this).keyup(function(){a.minchar<=r(this).val().length&&r("#"+c+"_bar:hidden")&&r("#"+c+"_bar").show(),r.fn.runPassword(r(this).val(),c,a)})})},runPassword:function(a,c,e){var t;nPerc=r.fn.checkPassword(a,e),t=nPerc<0?0:nPerc<=e.scores[0]?1:nPerc>e.scores[0]&&nPerc<=e.scores[1]?2:nPerc>e.scores[1]&&nPerc<=e.scores[2]?3:nPerc>e.scores[2]&&nPerc<=e.scores[3]?4:5,e.$ctlBar.css({width:e.values[t]+"%"}),e.$ctlBar.attr("aria-valuenow",e.values[t]),e.$ctlBar.css({backgroundColor:e.colors[t]}),e.$ctlText.html(e.verdicts[t])},checkPassword:function(r,a){var c=0;a.verdicts[0];return r.length<a.minchar?c-=100:r.length>a.minchar+1&&r.length<a.minchar+3?c+=6:r.length>a.minchar+2&&r.length<a.minchar+4?c+=12:r.length>2*a.minchar&&(c+=18),r.match(/[a-z]/)&&(c+=1),r.match(/[A-Z]/)&&(c+=5),r.match(/\d+/)&&(c+=5),r.match(/(.*[0-9].*[0-9].*[0-9])/)&&(c+=5),r.match(/.[!,@,#,$,%,^,&,*,?,_,~]/)&&(c+=5),r.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)&&(c+=5),r.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(c+=2),r.match(/([a-zA-Z])/)&&r.match(/([0-9])/)&&(c+=2),r.match(/([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])/)&&(c+=2),c}})}(jQuery);